<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html;" /> 
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<link rel="stylesheet" type="text/css" href="mainstyle/css/base.css">
<title>简单的html5 File测试 for pic2base64</title> 
<style> 

.file_wrapper{
    padding: 18px 0;
    background: #fff;
    width: 100%;
    overflow: hidden;
}

.file_box{
    float: left; width: 30%; height: 30%;position: relative; padding: 18px 1.5%; 
}

.file_box textarea ,.file_box p{ display:none; }

.add-img {
    display: block;
    width: 100px;
    height: 100px;
}

.file_box .file {
    width: 100%;
    height: 100%;
    opacity: 0;
    position: absolute;
    top: 0px;
    left: 0px;
    z-index: 100;
}

.img_area img {
    display: block;
    width: 100px;
    height: 100px;
    margin:0 auto;
}

.close-upimg {
    position: absolute;
    top: 16px;
    right: 16px;
    display: block;
    z-index: 101;
}
</style> 
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script> 
    window.onload = function(){ 
        var input = document.getElementById("demo_input"); 
        var result= document.getElementById("result"); 
        var img_area = document.getElementById("img_area"); 

        var input2 = document.getElementById("demo_input2"); 
        var result2= document.getElementById("result2"); 
        var img_area2 = document.getElementById("img_area2"); 

        var input2 = document.getElementById("demo_input3"); 
        var result2= document.getElementById("result3"); 
        var img_area2 = document.getElementById("img_area3"); 

        if ( typeof(FileReader) === 'undefined' ){
            result.innerHTML = "抱歉，你的浏览器不支持 FileReader，请使用现代浏览器操作！"; 
            document.getElementById("demo_input").setAttribute('disabled','disabled'); 
        }else{
            document.getElementById("demo_input").addEventListener('change',readFile,false);
            document.getElementById("demo_input2").addEventListener('change',readFile2,false);
            document.getElementById("demo_input3").addEventListener('change',readFile3,false);
        } 

        $(".file1").change(function(){
            var s=$(".file1").val();
                if(s!=''){
                  $(this).parent().find(".add-img").hide();
                  $(this).parent().find(".img_area").show();
                  $(".file_box2").show();
                  $(this).parent().append("<img class='close-upimg' src='mainstyle/images/a7.png'>")
                } 

        })
        
        $(".file2").change(function(){
            var s=$(".file2").val();
                if(s!=''){
                  $(this).parent().find(".add-img").hide();
                  $(this).parent().find(".img_area").show();
                  $(".file_box3").show();
                } 

        }) 

        $(".file3").change(function(){
            var s=$(".file3").val();
                if(s!=''){
                  $(this).parent().find(".add-img").hide();
                  $(this).parent().find(".img_area").show();
                } 

        })     
    }
    function readFile(){
        var file = document.getElementById("demo_input").files[0]; 
        console.log(file);
        //这里我们判断下类型如果不是图片就返回 去掉就可以上传任意文件   
        if(!/image\/\w+/.test(file.type)){
            alert("请确保文件为图像类型"); 
            return false; 
        }
        var reader = new FileReader(); 
        reader.readAsDataURL(file); 
        console.log();
        reader.onload = function(e){ 
                result.innerHTML =this.result; 
                img_area.innerHTML = '<img src="'+result.innerHTML+'" alt=""/>'; 
        }
    }

    function readFile2(){
        var file2 = document.getElementById("demo_input2").files[0]; 
        console.log(file2);
        //这里我们判断下类型如果不是图片就返回 去掉就可以上传任意文件   
        if(!/image\/\w+/.test(file2.type)){
            alert("请确保文件为图像类型"); 
            return false; 
        }
        var reader2 = new FileReader(); 
        reader2.readAsDataURL(file2); 
        console.log();
        reader2.onload = function(e){ 
                result2.innerHTML = this.result; 
                img_area2.innerHTML = '<img src="'+this.result+'" alt=""/>'; 
        }
    }

    function readFile3(){
        var file3 = document.getElementById("demo_input3").files[0]; 
        console.log(file3);
        //这里我们判断下类型如果不是图片就返回 去掉就可以上传任意文件   
        if(!/image\/\w+/.test(file3.type)){
            alert("请确保文件为图像类型"); 
            return false; 
        }
        var reader3 = new FileReader(); 
        reader3.readAsDataURL(file3); 
        console.log();
        reader3.onload = function(e){ 
                result3.innerHTML = this.result; 
                img_area3.innerHTML = '<img src="'+this.result+'" alt=""/>'; 
        } 
    }

  
</script> 


</head>

<body> 
    <form action="file.php" method="post">
    <div class="file_wrapper">
        <div class="file_box">
            <img src="mainstyle/images/a11.png" class="add-img">
            <p id="img_area" class="img_area"></p>
            <input  class="file1 file" type="file" value="sdgsdg" id="demo_input" /> 
            <textarea name="img" id="result"></textarea> 
            
        </div>
        <div class="file_box file_box2" style="display: none;">
            <img src="mainstyle/images/a11.png" class="add-img">
            <p id="img_area2" class="img_area"></p>
            <input  class="file2 file" type="file" value="sdgsdg" id="demo_input2" /> 
            <textarea name="img" id="result2"></textarea> 
            
        </div>
        <div class="file_box file_box3" style="display: none;">
            <img src="mainstyle/images/a11.png" class="add-img">
            <p id="img_area3" class="img_area"></p>
            <input  class="file3 file" type="file" value="sdgsdg" id="demo_input3" /> 
            <textarea name="img" id="result3"></textarea> 
            
        </div>
    </div>
   </form> 
    <!-- <form action="file.php" method="post">
        <input type="file" value="sdgsdg" id="demo_input2" /> 
        <textarea name="img2" id="result2"></textarea> 
        <p id="img_area2"></p>
    </form> -->
        <!-- <input type="submit" value="提交"> -->
    
    <!-- <form action="file.php" method="post">
        <input type="file" value="sdgsdg" id="demo_input3" /> 
        <textarea name="img" id="result3"></textarea> 
        <p id="img_area3"></p>
       
    </form> --> 
</body> 
</html>